---
title: "Utilize Worldwide Bureaucracy Indicators to implement public policies"
subtitle: "INFO 526 - Summer 2024 - Final Project"
author: "Mohammad Rahat Helal"
title-slide-attributes:
  data-background-image: None
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  "data/customtheming.scss"
editor: visual
execute:
  echo: true
---

```{r}
#| label: load-packages
#| message: false
#| output: false
#| echo: false

if(!require(pacman))
  install.packages("pacman")

pacman::p_load(
  here,
  tidyverse,
  ggrepel,
  devtools,
  tidytuesdayR,
  dplyr,
  readr,
  janitor,
  ggplot2,
  showtext,
  gridExtra
  )

options(width = 65)

knitr::opts_chunk$set(
  fig.asp = 0.618,
  fig.align = "center",
  fig.retina = 1,
  fig.showtext = T
)

```

```{r}
#| label: setup
#| include: false
#| message: false
#| output: false
#| echo: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))
# 
# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3,
  dpi = 300,
  fig.width = 6,
  fig.asp = 0.618
  )

```

## Introduction & Motivation

-   Selected datasets from the Worldwide Bureaucracy Indicators (WWBI)
-   Help gain insights into current scenarios of public policies
-   Understand the trends across geographies
-   How to improve or suggest improvements in country-specific needs and situations

## Dataset - Worldwide Bureaucracy Indicators

```{r}
#| label: load-data
#| message: false
#| echo: false
#| output: false

# Suppress all output during the data loading
invisible(capture.output({
  tuesdata <- tidytuesdayR::tt_load('2024-04-30')
}))

# create separate dataframes for each parts - data, series, and country
wwbi_data <- tuesdata$wwbi_data
wwbi_series <- tuesdata$wwbi_series
wwbi_country <- tuesdata$wwbi_country

```

-   **wwbi_data** information on the country code, bureaucracy indicator code, year and numeric value of data.
-   **wwbi_series** the bureaucracy indicator code and the name of the indicator
-   **wwbi_country** country code, detailed information on country's name, currency, region, income group etc.

## Questions

The two questions I want to answer:

### Question 1:

Compare the different regions globally, research how has public sector employment changed over time? Pick up one country in a region and research if there are underlying factors for such changes?

### Question 2:

In context of public administration in different geographies, what is the relationship between income group and public administration efficiency?

## Visualization - 1

```{r}
#| label: Question-1
#| message: false
#| echo: false

# replicate base data into three dataframes to analyze question 1
country_df <- wwbi_country 
data_df <- wwbi_data 
series_df <- wwbi_series 

# merge the three data frames on indicator code and country code 
merged_df <- merge(data_df, series_df, by = "indicator_code")
merged_df <- merge(merged_df, country_df, by = "country_code")

# Public sector employment
ps_empl_indicator <- merged_df %>%
  filter(str_detect(str_to_lower(indicator_name), "public sector employment"))

distinct_ps_empl_ind <- ps_empl_indicator %>%
  distinct(indicator_code, indicator_name)

# print(distinct_ps_empl_ind)

grouped_ps_empl_ind <- ps_empl_indicator %>%
  group_by(indicator_code, indicator_name) %>%
  summarise(record_count = n(), .groups = "drop") %>% 
  arrange(desc(record_count))

# print(grouped_ps_empl_ind)

# Filter for the public sector employment indicator
employment_data <- merged_df %>%
  filter(indicator_code == "BI.EMP.TOTL.PB.ZS")

# print(employment_data)

# Aggregate data by year and region
# aggregated_data <- employment_data %>%
#   group_by(year, region) %>%
#   summarise(mean_value = mean(value, na.rm = TRUE))

# Aggregate data by year and region
aggregated_data <- employment_data %>%
  group_by(year, region) %>%
  summarise(mean_value = mean(value, na.rm = TRUE), .groups = "drop")

aggregated_data_na <- aggregated_data %>%
  filter(region == "North America")

# Create plot_a with decreased width
plot_a <- ggplot(aggregated_data_na, aes(x = year, y = mean_value, color = region)) +
  geom_line() +
  geom_point() +
  labs(title = "Public Sector Employment as a Share of\nTotal Employment Over Time by Region\nNorth America",
       x = "Year",
       y = "Public Sector Employment Share (%)",
       color = "Region") +
  theme_minimal() +
  theme(text = element_text(size = 8),
        axis.text.y = element_text(size = 9),
        legend.position = "bottom",
        plot.margin = margin(10, 10, 10, 10))  # Add margin around plot_a

# Create plot_b with increased width
plot_b <- ggplot(aggregated_data, aes(x = year, y = mean_value, color = region)) +
  geom_line() +
  geom_point() +
  labs(title = "Public Sector Employment as a Share of\nTotal Employment Over Time by Region\nAll Geographies",
       x = "Year",
       y = "Public Sector Employment Share (%)",
       color = "Region") +
  theme_minimal() +
  theme(text = element_text(size = 8),
        axis.text.y = element_text(size = 9),
        legend.position = "bottom",
        plot.margin = margin(10, 10, 10, 10),
        legend.key.size = unit(0.5, "lines"),   
        legend.spacing.x = unit(0.2, "cm")    
        )  

# Display the plots side by side with adjusted widths
grid.arrange(plot_a, plot_b, ncol = 2, widths = c(0.45, 0.55))

```
